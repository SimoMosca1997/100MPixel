<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pixel Grid Editor</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background-color: #f4f4f4;
      overflow: hidden;
    }

    canvas {
      border: 1px solid #ccc;
      cursor: grab;
    }

    #popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      display: none;
      z-index: 10;
    }

    #popup input, #popup button {
      margin: 10px 0;
      padding: 10px;
      width: 100%;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    #popup button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }

    #popup button:hover {
      background-color: #0056b3;
    }

    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      z-index: 5;
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>

  <div id="overlay"></div>
  <div id="popup">
    <label for="imageUrl">Image URL:</label>
    <input type="text" id="imageUrl" placeholder="Enter image URL">
    <label for="linkUrl">Link URL:</label>
    <input type="text" id="linkUrl" placeholder="Enter link URL">
    <button id="savePixel">Save</button>
  </div>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    const gridSize = 10; // 10x10 grid
    const pixelSize = 50; // Size of each pixel
    canvas.width = gridSize * pixelSize;
    canvas.height = gridSize * pixelSize;

    const pixelData = {}; // Store data for each pixel

    let isDragging = false;
    let dragStart = { x: 0, y: 0 };
    let offset = { x: 0, y: 0 };
    let zoomLevel = 1;

    const popup = document.getElementById("popup");
    const overlay = document.getElementById("overlay");
    const imageUrlInput = document.getElementById("imageUrl");
    const linkUrlInput = document.getElementById("linkUrl");
    const savePixelButton = document.getElementById("savePixel");

    let selectedPixel = null;

    // Draw grid and images
    function drawGrid() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.setTransform(zoomLevel, 0, 0, zoomLevel, offset.x, offset.y);

      for (let x = 0; x < gridSize; x++) {
        for (let y = 0; y < gridSize; y++) {
          const key = `${x},${y}`;
          ctx.strokeStyle = "#ddd";
          ctx.strokeRect(x * pixelSize, y * pixelSize, pixelSize, pixelSize);

          if (pixelData[key] && pixelData[key].image) {
            const img = new Image();
            img.src = pixelData[key].image;
            img.onload = () => {
              ctx.drawImage(img, x * pixelSize, y * pixelSize, pixelSize, pixelSize);
            };
          }
        }
      }
    }

    // Open popup to set pixel data
    function openPopup(x, y) {
      selectedPixel = { x, y };
      popup.style.display = "block";
      overlay.style.display = "block";
    }

    // Save pixel data
    savePixelButton.addEventListener("click", () => {
      const x = selectedPixel.x;
      const y = selectedPixel.y;
      const key = `${x},${y}`;

      const imageUrl = imageUrlInput.value.trim();
      const linkUrl = linkUrlInput.value.trim();

      if (!imageUrl) {
        alert("Please provide a valid image URL!");
        return;
      }

      pixelData[key] = { image: imageUrl, link: linkUrl || null };
      drawGrid();

      popup.style.display = "none";
      overlay.style.display = "none";
      imageUrlInput.value = "";
      linkUrlInput.value = "";
    });

    // Handle canvas click
    canvas.addEventListener("click", (event) => {
      const rect = canvas.getBoundingClientRect();
      const x = Math.floor((event.clientX - rect.left - offset.x) / (pixelSize * zoomLevel));
      const y = Math.floor((event.clientY - rect.top - offset.y) / (pixelSize * zoomLevel));
      const key = `${x},${y}`;

      if (pixelData[key] && pixelData[key].link) {
        window.open(pixelData[key].link, "_blank");
      } else {
        openPopup(x, y);
      }
    });

    // Dragging to pan the canvas
    canvas.addEventListener("mousedown", (event) => {
      isDragging = true;
      dragStart.x = event.clientX - offset.x;
      dragStart.y = event.clientY - offset.y;
      canvas.style.cursor = "grabbing";
    });

    canvas.addEventListener("mousemove", (event) => {
      if (isDragging) {
        offset.x = event.clientX - dragStart.x;
        offset.y = event.clientY - dragStart.y;
        drawGrid();
      }
    });

    canvas.addEventListener("mouseup", () => {
      isDragging = false;
      canvas.style.cursor = "grab";
    });

    canvas.addEventListener("wheel", (event) => {
      event.preventDefault();
      const zoomAmount = -event.deltaY * 0.001;
      zoomLevel = Math.min(Math.max(0.5, zoomLevel + zoomAmount), 5);
      drawGrid();
    });

    overlay.addEventListener("click", () => {
      popup.style.display = "none";
      overlay.style.display = "none";
      imageUrlInput.value = "";
      linkUrlInput.value = "";
    });

    // Initial draw
    drawGrid();
  </script>
</body>
</html>
